# Firestore Database Structure - AlNourway

## Collections Overview

ูุฐุง ุงููุณุชูุฏ ูุดุฑุญ ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู Firestore ุจูุงุกู ุนูู ุงููุฎุทุท ุงูุฃุตูู ูู Base44.

---

## ๐ ูุงุฆูุฉ Collections (23 ุฌุฏูู)

### 1. **users** (ุงููุณุชุฎุฏููู)
- ูุฏูุฌ ูุน Firebase Authentication
- ูุญุชูู ุนูู: ุงูุงุณู ุงููุงููุ ุงูุจุฑูุฏุ ุงูุฏูุฑ (admin/user)

### 2. **islamicCenters** (ุงููุฑุงูุฒ ุงูุฅุณูุงููุฉ)
- ูุนูููุงุช ุงููุฑุงูุฒ ุงูุฅุณูุงููุฉ
- ูุญุชูู ุนูู: ุงูุงุณูุ ุงูุนููุงูุ ุงูุฎุฏูุงุชุ ุงููููุน ุงูุฌุบุฑุงูู

### 3. **lectures** (ุงููุญุงุถุฑุงุช)
- ูุญุงุถุฑุงุช ุตูุชูุฉ ููุฑุฆูุฉ
- ูุญุชูู ุนูู: ุงูุนููุงูุ ุงููุญุงุถุฑุ ุงูููุนุ ุงููุฆุฉุ ุงูุฅุญุตุงุฆูุงุช

### 4. **userPreferences** (ุชูุถููุงุช ุงููุณุชุฎุฏู)
- ุชูุถููุงุช ูู ูุณุชุฎุฏู
- ูุญุชูู ุนูู: ุงูููุงุถูุน ุงูููุถูุฉุ ุณุฌู ุงููุดุงูุฏุงุชุ ุงูุจุญุซ

### 5. **analyticsEvents** (ุฃุญุฏุงุซ ุงูุชุญูููุงุช)
- ุชุชุจุน ุชูุงุนู ุงููุณุชุฎุฏููู
- ูุญุชูู ุนูู: ููุน ุงูุญุฏุซุ ุงููุญุชููุ ุงูุจูุงูุงุช ุงูุฅุถุงููุฉ

### 6. **conversations** (ุงููุญุงุฏุซุงุช)
- ูุญุงุฏุซุงุช ุจูู ุงููุณุชุฎุฏููู ูุงูุนููุงุก
- ูุญุชูู ุนูู: ุฃุทุฑุงู ุงููุญุงุฏุซุฉุ ุขุฎุฑ ุฑุณุงูุฉุ ุงูุญุงูุฉ

### 7. **chatMessages** (ุฑุณุงุฆู ุงูุฏุฑุฏุดุฉ)
- ุงูุฑุณุงุฆู ุฏุงุฎู ุงููุญุงุฏุซุงุช
- ูุญุชูู ุนูู: ุงููุฑุณูุ ุงููุณุชูุจูุ ุงููุตุ ุงููุฑููุงุช

### 8. **contentRecommendations** (ุชูุตูุงุช ุงููุญุชูู)
- ุชูุตูุงุช ูุญุชูู ูุฎุตุตุฉ ูููุณุชุฎุฏููู
- ูุญุชูู ุนูู: ููุน ุงููุญุชููุ ุฏุฑุฌุฉ ุงูุชูุตูุฉุ ุงูุณุจุจ

### 9. **stories** (ุงููุตุต)
- ูุตุต ุงูุชูุจุฉ ูุงูุงูุชุฏุงุก
- ูุญุชูู ุนูู: ุงูุนููุงูุ ุงููุงุชุจุ ุงููุญุชููุ ุงููุฆุฉ

### 10. **fatwas** (ุงููุชุงูู)
- ูุชุงูู ุดุฑุนูุฉ
- ูุญุชูู ุนูู: ุงูุณุคุงูุ ุงูุฌูุงุจุ ุงูููุชูุ ุงููุฑุฌุน

### 11. **fatwaRequests** (ุทูุจุงุช ุงููุชูู)
- ุทูุจุงุช ุงููุณุชุฎุฏููู ูููุชุงูู
- ูุญุชูู ุนูู: ุงูุณุคุงูุ ุงูุญุงูุฉุ ุงูุฌูุงุจ

### 12. **contactRequests** (ุทูุจุงุช ุงูุชูุงุตู)
- ุทูุจุงุช ุงูุชูุงุตู ูุน ุงููุฑูู
- ูุญุชูู ุนูู: ุงูุงุณูุ ุงูุจุฑูุฏุ ููุน ุงูุทูุจุ ุงูุญุงูุฉ

### 13. **scholars** (ุงูุนููุงุก ูุงูุฏุนุงุฉ)
- ูุนูููุงุช ุงูุนููุงุก ูุงููุญูุธูู
- ูุญุชูู ุนูู: ุงูุงุณูุ ุงูุชุฎุตุตุ ุงููุบุงุชุ ูุนูููุงุช ุงูุชูุงุตู

### 14. **joinTeamRequests** (ุทูุจุงุช ุงูุงูุถูุงู ูููุฑูู)
- ุทูุจุงุช ุงูุงูุถูุงู ูุนุงูู ุฃู ุฏุงุนูุฉ
- ูุญุชูู ุนูู: ุงููุคููุงุชุ ุงูุฎุจุฑุงุชุ ุงูุญุงูุฉ

### 15. **favorites** (ุงูููุถูุฉ)
- ูุญุชูู ูุญููุธ ูู ุงููุณุชุฎุฏููู
- ูุญุชูู ุนูู: ููุน ุงููุญุชููุ ุงููุนุฑูุ ุงูุจูุงูุงุช

### 16. **books** (ุงููุชุจ)
- ููุชุจุฉ ุงููุชุจ ุงูุฅุณูุงููุฉ
- ูุญุชูู ุนูู: ุงูุนููุงูุ ุงููุคููุ ุงููุฆุฉุ ุฑุงุจุท PDF

### 17. **quranCourses** (ุฏูุฑุงุช ุงููุฑุขู)
- ุฏูุฑุงุช ุญูุธ ูุชุฌููุฏ ุงููุฑุขู
- ูุญุชูู ุนูู: ุงูุนููุงูุ ุงููุนููุ ุงูููุนุ ุงูููุงุนูุฏ

### 18. **courseEnrollments** (ุงูุชุณุฌูู ูู ุงูุฏูุฑุงุช)
- ุชุณุฌููุงุช ุงูุทูุงุจ ูู ุงูุฏูุฑุงุช
- ูุญุชูู ุนูู: ุงูุฏูุฑุฉุ ุงูุทุงูุจุ ุงูุญุงูุฉ

### 19. **comments** (ุงูุชุนูููุงุช)
- ุชุนูููุงุช ุนูู ุงููุญุชูู
- ูุญุชูู ุนูู: ุงููุณุชุฎุฏูุ ุงููุญุชููุ ุงููุตุ ุงูููุงููุฉ

### 20. **ratings** (ุงูุชููููุงุช)
- ุชููููุงุช ุงููุญุชูู
- ูุญุชูู ุนูู: ุงููุณุชุฎุฏูุ ุงูุชูููู (1-5), ุงููุฑุงุฌุนุฉ

### 21. **liveStreams** (ุงูุจุซ ุงููุจุงุดุฑ)
- ุฌุฏูู ุงูุจุซ ุงููุจุงุดุฑ
- ูุญุชูู ุนูู: ุงูุนููุงูุ ุงููุญุงุถุฑุ ุงูููุชุ ุฑุงุจุท ุงูุจุซ

### 22. **notifications** (ุงูุฅุดุนุงุฑุงุช)
- ุฅุดุนุงุฑุงุช ุงููุณุชุฎุฏููู
- ูุญุชูู ุนูู: ุงูุฑุณุงูุฉุ ุงูููุนุ ุญุงูุฉ ุงููุฑุงุกุฉ

### 23. **reconciliationCommittee** (ูุฌูุฉ ุงููุตุงูุญุฉ)
- ุจูุงูุงุช ูุฌูุฉ ุงููุตุงูุญุฉ
- ูุญุชูู ุนูู: (ุญุณุจ ุงูุงุญุชูุงุฌ)

---

## ๐ ุงูุนูุงูุงุช ุจูู Collections

### ุงูุนูุงูุงุช ุงููุจุงุดุฑุฉ:
- `chatMessages.conversation_id` โ `conversations.id`
- `courseEnrollments.course_id` โ `quranCourses.id`
- `comments.parent_comment_id` โ `comments.id` (ุนูุงูุฉ ุฐุงุชูุฉ)

### ุงูุนูุงูุงุช ุงูุถูููุฉ (Polymorphic):
- `userPreferences.view_history` โ ูุฑุชุจุท ุจู `lectures`, `books`, `fatwas`, `stories`
- `analyticsEvents.content_id` โ ูุฑุชุจุท ุจู ุฃู ูุญุชูู ุญุณุจ `content_type`
- `favorites.item_id` โ ูุฑุชุจุท ุจู ุฃู ูุญุชูู ุญุณุจ `item_type`

### ุงูุนูุงูุงุช ุจุงููุณุชุฎุฏููู:
- ูุนุธู ุงูู Collections ุชุญุชูู ุนูู `created_by` ุฃู `user_email` ููุฑุจุท ุจู `users`

---

## ๐๏ธ ููููุฉ ุฅูุดุงุก Collections ูู Firestore

### ุงูุทุฑููุฉ ุงูุฃููู: ูุฏููุงู ูู Firebase Console
1. ุงุฐูุจ ุฅูู Firestore Database
2. ุงุถุบุท "Start collection"
3. ุฃุฏุฎู ุงุณู ุงูู Collection
4. ุฃุถู ูุซููุฉ ุชุฌุฑูุจูุฉ ุจุญููู ูุซุงู

### ุงูุทุฑููุฉ ุงูุซุงููุฉ: ุจุฑูุฌูุงู (ููุตู ุจูุง)
ุงุณุชุฎุฏู ุงูู Script ุงููุฑูู ูุฅูุดุงุก ุฌููุน ุงูู Collections ุชููุงุฆูุงู.

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **Timestamps**: ุฌููุน ุงูู `created_date` ู `updated_date` ุชุณุชุฎุฏู `serverTimestamp()`
2. **Arrays**: ุงูุญููู ูู ููุน array ุชูุฎุฒู ูู Firestore Arrays
3. **Objects**: ุงูุญููู ุงููุชุฏุงุฎูุฉ ุชูุฎุฒู ูู Maps ูู Firestore
4. **References**: ูููู ุงุณุชุฎุฏุงู DocumentReferences ููุนูุงูุงุช ุงููููุฉ

---

## ๐ ููุงุนุฏ ุงูุฃูุงู

ุชุฃูุฏ ูู ุชุญุฏูุซ Firestore Rules ูุญูุงูุฉ ุงูุจูุงูุงุช:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // ุงูุณูุงุญ ูููุณุชุฎุฏููู ุงููุณุฌููู ููุท
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
    
    // ููุงุนุฏ ุฎุงุตุฉ ููู Collection ุญุณุจ ุงูุงุญุชูุงุฌ
  }
}
```

---

## โ ุงูุชุงูู

ุจุนุฏ ุฅูุดุงุก ุงูุจููุฉุ ููููู:
1. ุฅุถุงูุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ
2. ุจูุงุก ูุงุฌูุงุช ุงููุณุชุฎุฏู
3. ุชุทููุฑ API endpoints
4. ุฅุนุฏุงุฏ Cloud Functions ููุนูููุงุช ุงููุนูุฏุฉ
